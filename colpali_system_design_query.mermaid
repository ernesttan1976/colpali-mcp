graph TD
    A[üîç Search Query] --> B[üì§ POST /search]
    B --> C[üîÑ Background Search Task]
    C --> D[ü§ñ Encode Query]
    E[üóÑÔ∏è Search LanceDB]
    
    D --> F[üß† ColPali Model]
    F --> G[üìä Query Embedding]
    G --> E
    
    E --> H[üìè MaxSim Scoring]
    H --> I[üèÜ Rank Results]
    I --> J[üìã Format Response with Image URLs]
    J --> K[‚úÖ Return Top Matches to Client]
    
    C --> L[üìä Progress Updates]
    L --> M[‚è≥ Progress Tracker]
    
    classDef ui fill:#3b82f6,stroke:#1e40af,stroke-width:2px,color:white
    classDef api fill:#ef4444,stroke:#dc2626,stroke-width:2px,color:white
    classDef process fill:#10b981,stroke:#059669,stroke-width:2px,color:white
    classDef model fill:#8b5cf6,stroke:#7c3aed,stroke-width:2px,color:white
    classDef response fill:#f97316,stroke:#ea580c,stroke-width:2px,color:white
    classDef progress fill:#f59e0b,stroke:#d97706,stroke-width:2px,color:white
    
    class A ui
    class B api
    class C,H,I process
    class D,E,F,G model
    class J,K response
    class L,M progress